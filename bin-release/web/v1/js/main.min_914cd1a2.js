var __reflect=this&&this.__reflect||function(e,t,o){e.__class__=t,o?o.push(t):o=[t],e.__types__=e.__types__?o.concat(e.__types__):o},__extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);o.prototype=t.prototype,e.prototype=new o},GameObject=function(){function e(){this.shape=null,this.mask=null,this.destroyFlag=!1,e.objects.push(this)}return e.initial=function(t){e.objects=[],e.display=t},e.update=function(){e.objects.forEach(function(e){return e.updateContent()}),e.objects=e.objects.filter(function(e){return e.destroyFlag&&e["delete"](),!e.destroyFlag}),e.transit&&(e.allDestroy(),e.transit(),e.transit=null)},e.allDestroy=function(){e.objects=e.objects.filter(function(e){return e.destroy(),e["delete"](),!1})},e.prototype.destroy=function(){this.destroyFlag=!0},e.prototype.addDestroyMethod=function(){},e.prototype["delete"]=function(){this.addDestroyMethod(),this.shape&&(e.display.removeChild(this.shape),this.shape=null)},e.objects=[],e}();__reflect(GameObject.prototype,"GameObject");var PhysicsObject=function(e){function t(){var t=e.call(this)||this;return t.body=null,t.bodyShape=null,t}return __extends(t,e),t.prototype.addDestroyMethod=function(){CreateWorld.world.removeBody(this.body)},t.world=null,t}(GameObject);__reflect(PhysicsObject.prototype,"PhysicsObject");var Kill=function(e){function t(){var o=e.call(this)||this;o.kill=0,o.text=null,o.textColor=65339,t.I=o,o.textColor=Util.color(0,255,0);var i=window.localStorage.getItem("kill");return null==i&&(i="0",window.localStorage.setItem("kill",i)),o.kill=parseInt(i),o.text=Util.myText(0,0,"KILL : "+o.kill.toString()+" / 1000",100,.5,o.textColor,!0),GameObject.display.addChild(o.text),o}return __extends(t,e),t.prototype.onDestroy=function(){GameObject.display.removeChild(this.text),this.text=null},t.prototype.updateContent=function(){this.text.text="KILL : "+this.kill.toString()+" / 1000"},t.prototype.addKill=function(){this.kill+=1,window.localStorage.setItem("kill",this.kill.toString())},t.I=null,t}(GameObject);__reflect(Kill.prototype,"Kill");var Bullet=function(e){function t(t,o,i,n,s){var a=e.call(this)||this;return a.object=null,a.collisionFlag=!1,a.setObject(t,o,i,n),a.setShape(t,o,i,n,s),a.object.scaleX=.5,a.object.scaleY=.5,a}return __extends(t,e),t.prototype.setObject=function(e,t,o,i){this.object=new egret.DisplayObjectContainer,this.object.anchorOffsetX+=o/2,this.object.x=e,this.object.y=t,this.object.width=o,this.object.height=i,GameObject.display.addChild(this.object)},t.prototype.setShape=function(e,t,o,i,n){this.shape&&GameObject.display.removeChild(this.shape),this.shape=new egret.Shape,this.shape.x=0,this.shape.y=0,this.shape.graphics.beginFill(n),this.shape.graphics.drawRect(0,0,o,i),this.shape.graphics.endFill(),this.object.addChild(this.shape)},t.prototype["delete"]=function(){this.shape&&GameObject.display.removeChild(this.object)},t.prototype.updateContent=function(){},t}(GameObject);__reflect(Bullet.prototype,"Bullet");var DropItem;!function(e){e[e.NONE=0]="NONE",e[e.A=1]="A",e[e.B=2]="B"}(DropItem||(DropItem={}));var Enemy=function(e){function t(t,o,i,n){var s=e.call(this)||this;return s.object=null,s.dropMoney=10,s.hp=0,s.hpTextField=null,s.hpTextFieldColor=16711680,s.deadFlag=!1,s.setObject(t,o,i,n),s}return __extends(t,e),t.prototype.setObject=function(e,t,o,i){0>=o?(o=1,console.log("widthが0以下です")):0>=i&&(i=1,console.log("heightが0以下です")),this.object=new egret.DisplayObjectContainer,this.object.anchorOffsetX+=o/2,this.object.anchorOffsetY+=i/2,this.object.x=e,this.object.y=t,this.object.width=o,this.object.height=i,GameObject.display.addChild(this.object)},t.prototype.setHpText=function(){this.hpTextField=Util.myText(0,0,this.hp.toString(),100,.5,this.hpTextFieldColor,!0),this.object.addChild(this.hpTextField)},t.prototype.addDestroyMethod=function(){Money.I.money+=this.dropMoney},t.prototype.updateContent=function(){this.hpTextField.text=this.hp.toString()},t.prototype["delete"]=function(){this.shape&&GameObject.display.removeChild(this.object)},t}(GameObject);__reflect(Enemy.prototype,"Enemy");var RectEnemy=function(e){function t(t,o,i,n,s,a,r){var h=e.call(this,t,o,i,n)||this;return h.setShape(t,o,i,n,s),h.hp=a,h.dropMoney=r,h.setHpText(),h}return __extends(t,e),t.prototype.setShape=function(e,t,o,i,n){this.shape&&GameObject.display.removeChild(this.shape),this.shape=new egret.Shape,this.shape.x=0,this.shape.y=0,this.shape.graphics.beginFill(n),this.shape.graphics.drawRect(0,0,o,i),this.shape.graphics.endFill(),this.object.addChild(this.shape)},t}(Enemy);__reflect(RectEnemy.prototype,"RectEnemy");var CircleEnemy=function(e){function t(t,o,i,n,s,a,r,h){var l=e.call(this,t,o,i,n)||this;return l.setShape(t,o,s,a),l.hp=r,l.dropMoney=h,l.setHpText(),l}return __extends(t,e),t.prototype.setShape=function(e,t,o,i){this.shape&&GameObject.display.removeChild(this.shape),0>=o&&(o=1,console.log("radiusが0以下です")),this.shape=new egret.Shape,this.object.anchorOffsetX-=o/2,this.object.anchorOffsetY-=o/2,this.shape.x=0,this.shape.y=0,this.shape.graphics.beginFill(i),this.shape.graphics.drawCircle(0,0,o),this.shape.graphics.endFill(),this.object.addChild(this.shape)},t.prototype.setHpText=function(){this.hpTextField=Util.myText(0,0,this.hp.toString(),100,.5,this.hpTextFieldColor,!0),this.hpTextField.anchorOffsetX=this.hpTextField.width/2,this.hpTextField.anchorOffsetY=this.hpTextField.height/2,this.object.addChild(this.hpTextField)},t}(Enemy);__reflect(CircleEnemy.prototype,"CircleEnemy");var Ball=function(e){function t(t,o,i){var n=e.call(this)||this;return n.radius=null,n.setShape(t,o,i),n}return __extends(t,e),t.prototype.setShape=function(e,t,o){this.shape&&GameObject.display.removeChild(this.shape),this.shape=new egret.Shape,this.shape.x=e,this.shape.y=t,this.shape.graphics.beginFill(16711680),this.shape.graphics.drawCircle(0,0,o),this.shape.graphics.endFill(),GameObject.display.addChild(this.shape)},t.prototype.updateContent=function(){},t.I=null,t}(GameObject);__reflect(Ball.prototype,"Ball");var PhysicsBall=function(e){function t(t,o,i){var n=e.call(this)||this;return n.radius=null,n.setBody(t,o,i),n.setShape(t,o,i),n}return __extends(t,e),t.prototype.setBody=function(e,t,o){this.body=new p2.Body({mass:1,position:[e,t]}),this.bodyShape=new p2.Circle({radius:o,fixedRotation:!0}),this.body.addShape(this.bodyShape),CreateWorld.world.addBody(this.body)},t.prototype.setShape=function(e,t,o){this.shape&&GameObject.display.removeChild(this.shape),this.shape=new egret.Shape,this.shape.x=e,this.shape.y=t,this.shape.graphics.beginFill(16711680),this.shape.graphics.drawCircle(0,0,o),this.shape.graphics.endFill(),GameObject.display.addChild(this.shape)},t}(PhysicsObject);__reflect(PhysicsBall.prototype,"PhysicsBall");var MyBall=function(e){function t(t,o,i){var n=e.call(this,t,o,i)||this;return Ball.I=n,n}return __extends(t,e),t}(Ball);__reflect(MyBall.prototype,"MyBall");var GameOver=function(e){function t(){var t=e.call(this)||this;return t.textGameOver=null,t.textScore=null,t.textColor=65339,t.textGameOver=Util.myText(Game.width/2,Game.height/2-50,"GAME OVER",100,.5,t.textColor,!0),t.textGameOver.anchorOffsetX=t.textGameOver.width/2,t.textGameOver.anchorOffsetY=t.textGameOver.height/2,GameObject.display.addChild(t.textGameOver),t.textScore=Util.myText(Game.width/2,Game.height/2+50,"SCORE : "+Score.I.score,100,.5,t.textColor,!0),t.textScore.anchorOffsetX=t.textScore.width/2,t.textScore.anchorOffsetY=t.textScore.height/2,GameObject.display.addChild(t.textScore),Score.I.score>=Score.I.bestScore&&window.localStorage.setItem("bestScore",Score.I.score.toFixed()),GameObject.display.once(egret.TouchEvent.TOUCH_TAP,function(e){return t.tap(e)},t),t}return __extends(t,e),t.prototype.onDestroy=function(){GameObject.display.removeChild(this.textGameOver),this.textGameOver=null,GameObject.display.removeChild(this.textScore),this.textScore=null},t.prototype.updateContent=function(){GameObject.display.addChild(this.textGameOver),GameObject.display.addChild(this.textScore)},t.prototype.tap=function(e){GameObject.transit=Game.init,this.destroy()},t}(GameObject);__reflect(GameOver.prototype,"GameOver");var RandomEnemy;!function(e){e[e.NONE=0]="NONE",e[e.RECT=1]="RECT",e[e.CIRCLE=2]="CIRCLE",e[e.TRIANGLE=3]="TRIANGLE"}(RandomEnemy||(RandomEnemy={}));var GameScene=function(e){function t(){var t=e.call(this)||this;return t.createStage(),t}return __extends(t,e),t.prototype.createStage=function(){t.createEnemy()},t.createEnemy=function(){var e=2;switch(e){case RandomEnemy.RECT:var o=new RectEnemy(Game.width/2,Game.height/4,Game.width/4,Game.height/6,Util.color(0,0,255),3,10);t.enemy.push(o);break;case RandomEnemy.CIRCLE:var i=Game.width/6,n=i,s=i,a=new CircleEnemy(Game.width/2,Game.height/4,n,s,i,Util.color(0,0,255),3,10);t.enemy.push(a)}},t.prototype.addDestroyMethod=function(){},t.prototype.updateContent=function(){},t.enemy=[],t}(GameObject);__reflect(GameScene.prototype,"GameScene");var Box=function(e){function t(t,o,i,n,s){var a=e.call(this)||this;return a.setShape(t,o,i,n,s),a}return __extends(t,e),t.prototype.setShape=function(e,t,o,i,n){this.shape&&GameObject.display.removeChild(this.shape),this.shape=new egret.Shape,this.shape.anchorOffsetX+=o/2,this.shape.anchorOffsetY+=i/2,this.shape.x=e,this.shape.y=t,this.shape.graphics.beginFill(n),this.shape.graphics.drawRect(0,0,o,i),this.shape.graphics.endFill(),GameObject.display.addChild(this.shape)},t}(GameObject);__reflect(Box.prototype,"Box");var PhysicsBox=function(e){function t(t,o,i,n,s){var a=e.call(this)||this;return a.x=t,a.y=o,a.width=i,a.height=n,a.color=s,a.setShape(a.width,a.height),a}return __extends(t,e),t.prototype.setBody=function(e,t,o,i){this.body=new p2.Body({mass:1,position:[e,t],type:p2.Body.STATIC}),this.bodyShape=new p2.Box({width:o,height:i}),this.body.addShape(this.bodyShape),CreateWorld.world.addBody(this.body)},t.prototype.setShape=function(e,t){this.shape&&GameObject.display.removeChild(this.shape),this.shape=new egret.Shape,this.shape.anchorOffsetX+=e/2,this.shape.anchorOffsetY+=t/2,this.shape.x=this.body.position[0],this.shape.y=this.body.position[1],this.shape.graphics.beginFill(this.color),this.shape.graphics.drawRect(0,0,e,t),this.shape.graphics.endFill(),GameObject.display.addChild(this.shape)},t}(PhysicsObject);__reflect(PhysicsBox.prototype,"PhysicsBox");var MyBox=function(e){function t(t,o,i,n,s){return e.call(this,t,o,i,n,s)||this}return __extends(t,e),t.prototype.updateContent=function(){},t}(Box);__reflect(MyBox.prototype,"MyBox");var Main=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){GameObject.initial(this.stage),Util.init(this),Game.init(),egret.startTick(this.tickLoop,this)},t.prototype.tickLoop=function(e){return GameObject.update(),!1},t}(eui.UILayer);__reflect(Main.prototype,"Main");var Game=function(){function e(){}return e.init=function(){this.height=egret.MainContext.instance.stage.stageHeight,this.width=egret.MainContext.instance.stage.stageWidth,new Background,new GameScene,new Money,new Player(e.width/2,e.height/1.25,e.width/2.4,e.height/6,Util.color(255,0,0))},e}();__reflect(Game.prototype,"Game");var Background=function(e){function t(){var t=e.call(this)||this;return t.shape=new egret.Shape,t.shape.graphics.beginFill(Util.color(0,0,0)),t.shape.graphics.drawRect(0,0,Game.width,Game.height),t.shape.graphics.endFill(),GameObject.display.addChild(t.shape),t}return __extends(t,e),t.prototype.updateContent=function(){},t}(GameObject);__reflect(Background.prototype,"Background");var CreateWorld=function(e){function t(){var o=e.call(this)||this;return t.I=o,t.world.on("beginContact",o.collision,o),o}return __extends(t,e),t.prototype.createWorld=function(){t.world=new p2.World,t.world.sleepMode=p2.World.BODY_SLEEPING,t.world.gravity=[0,9.8]},t.worldBegin=function(e){return t.world.step(1/60,e/1e3,10),!1},t.prototype.collision=function(e){},t.prototype.addDestroyMethod=function(){t.world.clear()},t.prototype.updateContent=function(){},t.I=null,t}(PhysicsObject);__reflect(CreateWorld.prototype,"CreateWorld");var Money=function(e){function t(){var o=e.call(this)||this;o.money=0,o.bestMoney=0,o.text=null,o.textBest=null,o.textColor=65339,o.textColor=Util.color(0,255,0),t.I=o;var i=window.localStorage.getItem("money");return null==i&&(i="0",window.localStorage.setItem("money",i)),o.money=parseInt(i),o.text=Util.myText(0,0,"MONEY : 0",100,.5,o.textColor,!0),GameObject.display.addChild(o.text),o}return __extends(t,e),t.prototype.onDestroy=function(){GameObject.display.removeChild(this.text),this.text=null},t.prototype.updateContent=function(){this.text.text="MONEY : "+this.money.toFixed()},t.addMoney=function(e){t.I.money+=e,window.localStorage.setItem("money",t.I.money.toString())},t.I=null,t}(GameObject);__reflect(Money.prototype,"Money");var Player=function(e){function t(o,i,n,s,a){var r=e.call(this)||this;return t.I=r,r.setPlayerObject(o,i,n,s),r.setShape(o,i,n,s,a),t.object.scaleX=.5,t.object.scaleY=.5,t.shotTimer=new egret.Timer(t.shotInterval,0),t.shotTimer.addEventListener(egret.TimerEvent.TIMER,r.shot,r),t.shotTimer.start(),r}return __extends(t,e),t.prototype.setPlayerObject=function(e,o,i,n){t.object=new egret.DisplayObjectContainer,t.object.anchorOffsetX+=i/2,t.object.x=e,t.object.y=o,t.object.width=i,t.object.height=n,GameObject.display.addChild(t.object)},t.prototype.setShape=function(e,o,i,n,s){this.shape&&GameObject.display.removeChild(this.shape),this.shape=new egret.Shape,this.shape.x=0,this.shape.y=0,this.shape.graphics.beginFill(s),this.shape.graphics.drawRect(0,0,i,n),this.shape.graphics.endFill();var a=this.setMask(this.shape.x,this.shape.y,this.shape.width/3,this.shape.height/2,Util.color(0,0,0)),r=this.setMask(this.shape.x+2*this.shape.width/3,this.shape.y,this.shape.width/3,this.shape.height/2,Util.color(0,0,0));t.object.addChild(this.shape),t.object.addChild(a),t.object.addChild(r)},t.prototype.setMask=function(e,t,o,i,n){var s=new egret.Shape;return s.x=e,s.y=t,s.graphics.beginFill(n),s.graphics.drawRect(0,0,o,i),s.graphics.endFill(),s},t.prototype.shot=function(){var e=new Bullet(Game.width/2,Game.height/1.35,Game.width/12,Game.height/12,Util.color(255,255,0));t.bullet.push(e)},t.prototype.updateContent=function(){t.bullet.forEach(function(e){e.object.y-=t.bulletMoveSpeed,e.object.y<0&&e.destroy(),GameScene.enemy.forEach(function(o){0==e.collisionFlag&&o.object.y>=e.object.y&&0==o.deadFlag&&(o.hp-=t.bulletDamage,MyTween.knockBack(o.object),e.destroy(),e.collisionFlag=!0,o.hp<=0&&(o.hp=0,o.deadFlag=!0,Money.addMoney(o.dropMoney),MyTween.enemyFadeOut(o.object,o)))})})},t.I=null,t.object=null,t.shotTimer=null,t.shotInterval=1e3,t.bullet=[],t.bulletDamage=1,t.bulletMoveSpeed=5,t}(GameObject);__reflect(Player.prototype,"Player");var Score=function(e){function t(){var o=e.call(this)||this;o.score=0,o.bestScore=0,o.text=null,o.textBest=null,o.textColor=65339,o.textColor=Util.color(0,255,0),t.I=o,o.score=0,o.text=Util.myText(0,0,"SCORE : 0",100,.5,o.textColor,!0),GameObject.display.addChild(o.text);var i=window.localStorage.getItem("bestScore");return null==i&&(i="0",window.localStorage.setItem("bestScore",i)),o.bestScore=parseInt(i),o.textBest=Util.myText(0,50,"BEST : "+i,100,.5,o.textColor,!0),GameObject.display.addChild(o.textBest),o}return __extends(t,e),t.prototype.onDestroy=function(){GameObject.display.removeChild(this.text),this.text=null,GameObject.display.removeChild(this.textBest),this.textBest=null},t.prototype.updateContent=function(){this.text.text="SCORE : "+this.score.toFixed(),this.bestScore<this.score&&(this.bestScore=this.score,this.textBest.text="BEST : "+this.score.toFixed())},t.prototype.addScore=function(){this.score+=1},t.I=null,t}(GameObject);__reflect(Score.prototype,"Score");var Tween=function(e){function t(){var t=e.call(this)||this;t.object=null;var o=new egret.Shape;return o.graphics.beginFill(16711680),o.graphics.drawRect(0,0,100,100),o.graphics.endFill(),o.x=o.y=400,GameObject.display.addChild(o),egret.Tween.get(o,{loop:!0,onChange:t.onChange,onChangeObj:t}).to({rotation:360},1e3).call(t.onComplete,t,["param1",{key:"key",value:3}]),t}return __extends(t,e),t.prototype.onChange=function(){},t.prototype.onComplete=function(e,t){},t}(egret.DisplayObjectContainer);__reflect(Tween.prototype,"Tween");var MyTween=function(){function e(){}return e.fadeOut=function(e,t){void 0==t&&(t=null),egret.Tween.get(e).to({alpha:.5},1e3).call(function(){egret.Tween.removeTweens(e),(void 0!=t||null!=t)&&t.destroy()})},e.enemyFadeOut=function(e,t){void 0==t&&(t=null),egret.Tween.get(e).to({alpha:.2},1e3).call(function(){egret.Tween.removeTweens(e),(void 0!=t||null!=t)&&(t.destroy(),GameScene.createEnemy())})},e.knockBack=function(e){var t=e.y;egret.Tween.get(e).to({y:t-50},100,egret.Ease.elasticIn).to({y:t},200,egret.Ease.sineIn)},e}();__reflect(MyTween.prototype,"MyTween");var FadeOut=function(){function e(){}return e.fadeOut=function(e,t){void 0==t&&(t=null),egret.Tween.get(e).to({alpha:.2},1e3).call(function(){egret.Tween.removeTweens(e),(void 0!=t||null!=t)&&t.destroy()})},e}();__reflect(FadeOut.prototype,"FadeOut");var EnemyFadeOut=function(){function e(){}return e}();__reflect(EnemyFadeOut.prototype,"EnemyFadeOut");var Util=function(){function e(){}return e.init=function(e){this.height=e.stage.stageHeight,this.width=e.stage.stageWidth,this.ui=e},e.random=function(e,t){return e+Math.random()*(t-e)},e.randomInt=function(e,t){return Math.floor(e+Math.random()*(t+.999-e))},e.clamp=function(e,t,o){return t>e&&(e=t),e>o&&(e=o),e},e.color=function(e,t,o){var i=e.toFixed(0),n=t.toFixed(0),s=o.toFixed(0);i=e.toString(16),n=t.toString(16),s=o.toString(16),i=("00"+i).slice(-2),n=("00"+n).slice(-2),s=("00"+s).slice(-2);var a=parseInt("0x"+i+n+s,16);return a},e.myText=function(e,t,o,i,n,s,a){var r=new egret.TextField;return r.x=e,r.y=t,r.text=o,r.bold=a,r.size=i,r.scaleX=n,r.scaleY=n,r.textColor=s,r.multiline=!0,r},e.myStrokeText=function(e,t,o,i,n,s,a,r,h){var l=new egret.TextField;return l.x=e,l.y=t,l.scaleX=n,l.scaleY=n,l.textFlow=[{text:o,style:{textColor:s,size:i,fontFamily:a,strokeColor:r,stroke:h}}],l},e}();__reflect(Util.prototype,"Util");